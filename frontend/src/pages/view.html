<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Student Records</title>
    <link rel="stylesheet" type="text/css" href="css/styles.css" />
  </head>
  <body>
    <h2 style="color: blue">Student Records</h2>
    <table border="1" width="100%">
      <thead>
        <tr>
          <th>Student ID</th>
          <th>Student Name</th>
          <th>GPA</th>
          <th>Grade</th>
          <th>Edit</th>
          <th>Delete</th>
        </tr>
      </thead>
      <tbody id="studentTableBody">
        <!-- Student records from localStorage will be inserted here -->
      </tbody>
    </table>
    <br />
    <a href="index.html">Back to Form</a>

    <script>
      function loadStudents() {
        let students = localStorage.getItem("students");
        const tableBody = document.getElementById("studentTableBody");

        if (students) {
          students = JSON.parse(students);
          tableBody.innerHTML = ""; // Clear existing rows
          students.forEach((student) => {
            const row = document.createElement("tr");
            row.innerHTML = `
            <td>${student.sid}</td>
            <td>${student.sname}</td>
            <td>${student.gpa}</td>
            <td>${student.grade}</td>
            <td><a href='edit.html?sid=${student.sid}'>Edit</a></td>
            <td><a href='#' onclick='deleteStudent("${student.sid}")'>Delete</a></td>`;
            tableBody.appendChild(row);
          });
        } else {
          tableBody.innerHTML =
            '<tr><td colspan="6">No records found</td></tr>';
        }
      }

      function deleteStudent(sid) {
        let students = localStorage.getItem("students");

        if (students) {
          students = JSON.parse(students);
          // Find index of the student with the specified sid
          const index = students.findIndex((student) => student.sid === sid);
          if (index !== -1) {
            // Remove the student from the array
            students.splice(index, 1);
            // Update local storage with the modified array
            localStorage.setItem("students", JSON.stringify(students));
            // Reload the table after deletion
            loadStudents();
          }
        }
      }

      window.onload = loadStudents;
    </script>
  </body>
</html>
